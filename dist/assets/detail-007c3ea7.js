import{A as I,_ as x,r as u,j as L,o as d,c as m,k as _,a as r,b as n,w as g,d as h,v as b,F as v,l as k,t as a}from"./index-93209f80.js";const C="http://localhost:8848/";function N(e){return I({method:"POST",data:e,url:C+"submitReply"})}function D(e){return I({method:"GET",url:C+"getReplyList?discussId="+e})}const B={bind(e,t,l){function y(c){if(e.contains(c.target))return!1;t.expression&&t.value(c)}e.vueClickOutside=y,document.addEventListener("click",y)},update(){},unbind(e,t){document.removeEventListener("click",e.vueClickOutside),delete e.vueClickOutside}},F={name:"reply",data(){return{row:"",btnShow:!1,index:"0",replyComment:"",myName:"Lana Del Rey",myHeader:"https://ae01.alicdn.com/kf/Hd60a3f7c06fd47ae85624badd32ce54dv.jpg",myId:19870621,to:"",toId:-1,comments:[{name:"Lana Del Rey",id:19870621,headImg:"https://ae01.alicdn.com/kf/Hd60a3f7c06fd47ae85624badd32ce54dv.jpg",comment:"我发布一张新专辑Norman Fucking Rockwell,大家快来听啊",createTime:"2019年9月16日 18:43",commentNum:2,like:15,inputShow:!1,reply:[{from:"Taylor Swift",fromId:19891221,fromHeadImg:"https://ae01.alicdn.com/kf/H94c78935ffa64e7e977544d19ecebf06L.jpg",to:"Lana Del Rey",toId:19870621,comment:"我很喜欢你的新专辑！！",createTime:"2019年9月16日 18:43",commentNum:1,like:15,inputShow:!1},{from:"Ariana Grande",fromId:1123,fromHeadImg:"https://ae01.alicdn.com/kf/Hf6c0b4a7428b4edf866a9fbab75568e6U.jpg",to:"Lana Del Rey",toId:19870621,comment:"别忘记宣传我们的合作单曲啊",createTime:"2019年9月16日 18:43",commentNum:0,like:5,inputShow:!1}]},{name:"Taylor Swift",id:19891221,headImg:"https://ae01.alicdn.com/kf/H94c78935ffa64e7e977544d19ecebf06L.jpg",comment:"我发行了我的新专辑Lover",createTime:"2019年9月16日 18:43",commentNum:1,like:5,inputShow:!1,reply:[{from:"Lana Del Rey",fromId:19870621,fromHeadImg:"https://ae01.alicdn.com/kf/Hd60a3f7c06fd47ae85624badd32ce54dv.jpg",to:"Taylor Swift",toId:19891221,comment:"新专辑和speak now 一样棒！",createTime:"2019年9月16日 18:43",commentNum:25,like:5,inputShow:!1}]},{name:"Norman Fucking Rockwell",id:20190830,headImg:"https://ae01.alicdn.com/kf/Hdd856ae4c81545d2b51fa0c209f7aa28Z.jpg",comment:"Plz buy Norman Fucking Rockwell on everywhere",createTime:"2019年9月16日 18:43",commentNum:0,like:5,inputShow:!1,reply:[]}]}},directives:{clickoutside:B},methods:{inputFocus(){var e=document.getElementById("replyInput");e.style.padding="8px 8px",e.style.border="2px solid blue",e.focus()},showReplyBtn(){this.btnShow=!0},hideReplyBtn(){this.btnShow=!1,replyInput.style.padding="10px",replyInput.style.border="none"},showReplyInput(e,t,l){this.comments[this.index].inputShow=!1,this.index=e,this.comments[e].inputShow=!0,this.to=t,this.toId=l},_inputShow(e){return this.comments[e].inputShow},sendComment(){if(!this.replyComment)this.$message({showClose:!0,type:"warning",message:"评论不能为空"});else{let e={},t=document.getElementById("replyInput");e.fromId=this.$store.state.uid,e.toId=this.row.uid,e.context=this.replyComment,e.replyId=this.row.discussId,e.replyType=1,console.log(e),N(e),this.replyComment="",t.innerHTML=""}},sendCommentReply(e){if(!this.replyComment)this.$message({showClose:!0,type:"warning",message:"评论不能为空"});else{let t={};t.fromId=this.$store.state.uid,t.toId=this.comments[e].toId,t.context=this.replyComment,t.replyId=this.comments[e].id,t.replyType=2,console.log(t),this.replyComment="",document.getElementsByClassName("reply-comment-input")[e].innerHTML=""}},onDivInput:function(e){this.replyComment=e.target.innerHTML},dateStr(e){var t=new Date().getTime();t=parseInt((t-e)/1e3);var l;if(t<60*10)return"刚刚";if(t<60*60&&t>=60*10)return l=Math.floor(t/60),l+"分钟前";if(t<60*60*24&&t>=60*60)return l=Math.floor(t/60/60),l+"小时前";if(t<60*60*24*30&&t>=60*60*24)return l=Math.floor(t/60/60/24),l+"天前";var e=new Date(parseInt(e));return e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()}},created:function(){this.row=JSON.parse(this.$store.state.discuss),D(this.row.discussId).then(e=>{console.log(e),this.comments=e.data.data}).catch(e=>{console.log(e),ElMessage.error("请求超时，请重试！")})}},M={class:"reply-info"},$={class:"reply-btn-box"},j={class:"author-info"},E={class:"author-name"},z={class:"author-time"},P={class:"icon-btn"},O=["onClick"],A=n("i",{class:"iconfont"},null,-1),V={class:"talk-box"},q={class:"reply"},G={class:"reply-box"},J={class:"author-info"},U={class:"author-name"},Y={class:"author-time"},Z={class:"talk-box"},K={class:"reply"},Q=n("div",{class:"reply-box"},null,-1),W={class:"my-reply my-comment-reply"},X={class:"reply-info"},ee={class:"reply-btn-box"};function te(e,t,l,y,c,o){const p=u("el-avatar"),w=u("el-button"),S=u("ChatDotSquare"),T=u("el-icon"),R=L("clickoutside");return d(),m("div",null,[_((d(),m("div",{onClick:t[2]||(t[2]=(...s)=>o.inputFocus&&o.inputFocus(...s)),class:"my-reply"},[r(p,{class:"header-img",size:40,src:c.myHeader},null,8,["src"]),n("div",M,[n("div",{tabindex:"0",contenteditable:"true",id:"replyInput",spellcheck:"false",placeholder:"输入评论...",class:"reply-input",onFocus:t[0]||(t[0]=(...s)=>o.showReplyBtn&&o.showReplyBtn(...s)),onInput:t[1]||(t[1]=s=>o.onDivInput(s))},null,32)]),_(n("div",$,[r(w,{class:"reply-btn",size:"medium",onClick:o.sendComment,type:"primary"},{default:g(()=>[h("发表评论")]),_:1},8,["onClick"])],512),[[b,c.btnShow]])])),[[R,o.hideReplyBtn]]),(d(!0),m(v,null,k(c.comments,(s,f)=>(d(),m("div",{key:f,class:"author-title reply-father",style:{"text-align":"left"}},[r(p,{class:"header-img",size:40,src:s.headImg},null,8,["src"]),n("div",j,[n("span",E,a(s.name),1),n("span",z,a(s.createTime),1)]),n("div",P,[n("span",{onClick:i=>o.showReplyInput(f,s.name,s.id)},[A,r(T,null,{default:g(()=>[r(S)]),_:1}),h(a(s.commentNum),1)],8,O)]),n("div",V,[n("p",null,[n("span",q,a(s.comment),1)])]),n("div",G,[(d(!0),m(v,null,k(s.reply,(i,H)=>(d(),m("div",{key:H,class:"author-title"},[r(p,{class:"header-img",size:40,src:i.fromHeadImg},null,8,["src"]),n("div",J,[n("span",U,a(i.from),1),n("span",Y,a(i.createTime),1)]),n("div",Z,[n("p",null,[n("span",null,"回复 @"+a(i.to)+":",1),n("span",K,a(i.comment),1)])]),Q]))),128))]),_(n("div",W,[r(p,{class:"header-img",size:40,src:c.myHeader},null,8,["src"]),n("div",X,[n("div",{tabindex:"0",contenteditable:"true",spellcheck:"false",placeholder:"输入评论...",onInput:t[3]||(t[3]=i=>o.onDivInput(i)),class:"reply-input reply-comment-input"},null,32)]),n("div",ee,[r(w,{class:"reply-btn",size:"medium",onClick:i=>o.sendCommentReply(f,e.j),type:"primary"},{default:g(()=>[h("发表评论")]),_:2},1032,["onClick"])])],512),[[b,o._inputShow(f)]])]))),128))])}const ne=x(F,[["render",te]]);const se={data:function(){return{row:""}},methods:{},components:{reply:ne,Prism},created:function(){this.row=JSON.parse(this.$store.state.discuss),console.log(this.row)},mounted:function(){Prism.highlightAll()}},oe={style:{"margin-bottom":"50px","padding-top":"50px","padding-left":"0px",width:"70%",float:"left"}},le={style:{"padding-bottom":"20px","background-color":"white",padding:"10px 10px 10px 10px"}},ae={style:{"text-align":"left"}},ie={style:{"text-align":"left"}},re=["innerHTML"],ce=n("div",{style:{"text-align":"left"}},[n("h2",null,"评论")],-1),de=n("div",{style:{"padding-top":"50px","padding-left":"0px",float:"left",width:"30%"}},[n("pre",null,[h("        "),n("code",{class:"language-py line-numbers"},`
              handleFileClick (a, b, c) {
                if (
                  a['type'] === 'file' &&
                  !a['name'].match('.pyc') &&
                  !a['name'].match('.pth')
                ) {
                  this.showPreview = false
                  this.loadCodePreview(a['path'])
                }
              }
        `),h(`
      `)])],-1);function me(e,t,l,y,c,o){const p=u("reply");return d(),m(v,null,[n("div",oe,[n("div",le,[n("h2",ae,a(e.row.title),1),n("div",ie,a(e.row.username)+" 发布于:"+a(e.row.createTime),1)]),n("div",{class:"editor-content-view",innerHTML:e.row.context,style:{"background-color":"white",padding:"10px 10px 10px 10px"}},null,8,re),n("div",null,[ce,r(p)])]),de],64)}const ue=x(se,[["render",me]]);export{ue as default};
